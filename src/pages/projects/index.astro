---
import { getCollection } from "astro:content"
import PageLayout from "@layouts/PageLayout.astro"
import TopLayout from "@layouts/TopLayout.astro"
import BottomLayout from "@layouts/BottomLayout.astro"
import ArrowCard from "@components/ArrowCard.astro"
import Link from "@components/Link.astro"
import Tags from "@components/Tags.astro"
import { PROJECTS } from "@consts"

const projects = (await getCollection("projects"))
	.filter((project) => !project.data.draft)
	.sort((a, b) => b.data.date.getTime() - a.data.date.getTime())

const tags = [
	...new Set(projects.flatMap((project) => project.data.tags)),
].sort((a, b) => a.localeCompare(b))
---

<PageLayout title={PROJECTS.TITLE} description={PROJECTS.DESCRIPTION}>
	<TopLayout>
		<div class="animate">
			<h1 class="text-3xl font-semibold text-black dark:text-white mt-2">
				{PROJECTS.TITLE}
			</h1>
			<div class="mt-1">
				{PROJECTS.DESCRIPTION}
			</div>
			<div class="mt-2">
				<Tags tags={tags} />
			</div>
		</div>
	</TopLayout>
	<BottomLayout>
		<ul class="animate flex flex-col gap-4">
			{
				projects.map((project) => (
					<li data-tagged={project.data.tags.join(",")}>
						<ArrowCard entry={project} />
					</li>
				))
			}
		</ul>
		<p class="text-center mt-10">
			<span>The projects above are my favorite,</span>
			<br />
			ðŸ‘‡
			<br />
			<Link
				href="https://github.com/henryhale?tab=repositories"
				aria-label="Check out all my projects on GitHub"
			>
				View all projects on GitHub.
			</Link>
		</p>
	</BottomLayout>
</PageLayout>
